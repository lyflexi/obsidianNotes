
ä¹‹å‰åœ¨kubernetesä¸­å®Œæˆçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯é€šè¿‡å‘½ä»¤è¡Œå·¥å…·kubectlå®Œæˆçš„ã€‚å…¶å®ï¼Œä¸ºäº†æä¾›æ›´ä¸°å¯Œçš„ç”¨æˆ·ä½“éªŒï¼Œkubernetesè¿˜å¼€å‘äº†ä¸€ä¸ªåŸºäºwebçš„ç”¨æˆ·ç•Œé¢ï¼ˆDashBoardï¼‰ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨DashBoardéƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ï¼Œè€Œä¸”è¿˜å¯ä»¥ç›‘æ§åº”ç”¨çš„çŠ¶æ€ï¼Œæ‰§è¡Œæ•…éšœæ’æŸ¥ä»¥åŠç®¡ç†kubernetesä¸­çš„å„ç§èµ„æºã€‚

# 2 éƒ¨ç½²DashBoard

  

## 2.1 ä¸‹è½½yamlï¼Œå¹¶è¿è¡ŒDashBoard

  

ä¸‹è½½yamlï¼ˆç½‘ç»œä¸è¡Œï¼Œè¯·ç‚¹è¿™é‡Œ[ğŸ“recommended.yaml](https://www.yuque.com/attachments/yuque/0/2021/yaml/750797/1625816410964-1a54e93a-adc2-4fcf-8018-6731eb888e10.yaml)ï¼‰ï¼š

```
wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml
```

ä¿®æ”¹kubernetes-dashboardçš„Serviceç±»å‹
```
vim recommended.yaml
```
recommended.yaml
```
kind: Service
apiVersion: v1
metadata:
  labels:
    k8s-app: kubernetes-dashboard
  name: kubernetes-dashboard
  namespace: kubernetes-dashboard
spec:
  type: NodePort # æ–°å¢
  ports:
    - port: 443
      targetPort: 8443
      nodePort: 30009 # æ–°å¢
  selector:
    k8s-app: kubernetes-dashboard
```
![[Pasted image 20240201103337.png]]

éƒ¨ç½²DashBoardï¼š
```
kubectl create -f recommended.yaml
```

![[Pasted image 20240201103343.png]]
æŸ¥çœ‹namespaceä¸ºkubernetes-dashboardä¸‹çš„èµ„æºï¼š
```
kubectl get pod,svc -n kubernetes-dashboard
```

![[Pasted image 20240201103350.png]]
## 2.2 åˆ›å»ºè´¦æˆ·ï¼Œè·å–token

  

åˆ›å»ºè´¦æˆ·ï¼š
```
kubectl create serviceaccount dashboard-admin -n kubernetes-dashboard
```

  ![[Pasted image 20240201103515.png]]

æˆæƒï¼š
```
kubectl create clusterrolebinding dashboard-admin-rb --clusterrole=cluster-admin --serviceaccount=kubernetes-dashboard:dashboard-admin
```

![[Pasted image 20240201103522.png]]
  
è·å–è´¦å·tokenï¼š
```
kubectl get secrets -n kubernetes-dashboard | grep dashboard-admin
```
![[Pasted image 20240201103526.png]]


```
kubectl describe secrets dashboard-admin-token-b992l -n kubernetes-dashboard
```
![[Pasted image 20240201103531.png]]
## 2.3 é€šè¿‡æµè§ˆå™¨è®¿é—®DashBoardçš„UI

  
åœ¨ç™»å½•é¡µé¢ä¸Šè¾“å…¥ä¸Šé¢çš„tokenï¼Œè®¿é—®åœ°å€ä¸º[https://192.168.18.100:30009/#/login](https://192.168.18.100:30009/#/login)ï¼š

![](https://cdn.nlark.com/yuque/0/2021/png/513185/1610074900379-20661743-2dbc-40cd-86e8-d19ce778ffcb.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_6K645aSn5LuZ%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)

  

å‡ºç°ä¸‹é¢çš„é¡µé¢ä»£è¡¨æˆåŠŸéƒ¨ç½²DashBoardï¼š
![[Pasted image 20240201103645.png]]
# è¯´æ˜:

Â å‡çº§äº†æ–°ç‰ˆæœ¬çš„Dashboardï¼ˆè¿™é‡Œä½¿ç”¨çš„v1.8.3ï¼‰ï¼Œä½¿ç”¨äº†è¾ƒä¸ºå¤æ‚çš„åŒå› å­ç™»å½•ï¼Œæ­£ç¡®è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ä¹‹åè¿˜éœ€è¦Tokenæˆ–è€…kubeconfigå†æ¬¡è®¤è¯ï¼Œä¿éšœäº†ç³»ç»Ÿå®‰å…¨ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›ä¸ä¾¿ã€‚é»˜è®¤çš„Tokenå¤±æ•ˆæ—¶é—´DefaultTokenTTLæ˜¯900ç§’ï¼Œä¹Ÿå°±æ˜¯15åˆ†é’Ÿï¼Œè¿™æ„å‘³ç€ä½ æ¯éš”15åˆ†é’Ÿå°±è¦è®¤è¯ä¸€æ¬¡ã€‚

```
// Expiration time (in seconds) of tokens generated by dashboard. Default: 15 min.
DefaultTokenTTL = 900
```

Dashboardçš„Tokenå¤±æ•ˆæ—¶é—´å¯ä»¥é€šè¿‡ token-ttl å‚æ•°æ¥è®¾ç½®ï¼Œä¿®æ”¹åˆ›å»ºDashboardçš„yamlæ–‡ä»¶ï¼Œå¹¶é‡æ–°åˆ›å»ºå³å¯ã€‚

```
ports:
- containerPort: 8443
  protocol: TCP
args:
  - --auto-generate-certificates
  - --token-ttl=43200
```